{% extends 'base/panel.html' %}

{% load static %}

{% block header %}{{ context_title }}{% endblock %}
{% block title %}{{ context_title }}{% endblock %}

{% block css %}
<link rel="stylesheet" href="{% static 'datatable/css/dataTables.bootstrap4.min.css' %}">
{% endblock %}

{% block script %}
<script src="{% static 'datatable/js/jquery.dataTables.min.js' %}"></script>
<script src="{% static 'datatable/js/dataTables.responsive.min.js' %}"></script>
<script src="{% static 'datatable/js/dataTables.bootstrap4.min.js' %}"></script>
<script src="{% static 'datatable/js/dataTables.responsive.min.js' %}"></script>
<script>
  $(document).ready(function() {
    $('#table').DataTable();
  });
</script>
{% endblock %}

{% block content %}

{% include 'helpers/messages.html' %}

{% if context_view == 'folder' %}
<div class="panel-body">
  <table id="table" class="table table-striped table-bordered dt-responsive nowrap" style="width:100%">
    <thead>
      <tr>
        <th>Folder</th>
        <th>Type</th>
        <th>Synced Date</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      {% for field in object %}
      <tr>
        <td><i class="fa fa-folder"></i> {{ field.folder }}</td>
        <td>{% if field.type_record == 'ada' %}AUTO DEDUCTION ADVICE{% else %}IT EQUIPMENT / SFA{% endif %}</td>
        <td>{{ field.date_record }}</td>
        <th>
          <ul class="list-inline">
            <li class="list-inline-item">
              <a href="{% url 'core:record' type=field.type_record folder=field.pk %}" class="btn btn-md btn-primary"><i class="fa fa-search"></i> View</a>
            </li>
            <li class="list-inline-item">
              <a href="{% url 'core:updatefolder' pk=field.pk %}" class="btn btn-md btn-primary"><i class="fa fa-pencil"></i> Edit</a>
            </li>
            <li class="list-inline-item">
              <form action="{% url 'core:deletefolder' type=field.type_record pk=field.pk %}" method="post" onsubmit="return confirm('Are you sure to delete this folder? It will remove also its content.');">
                {% csrf_token %}
                <button type="submit" class="btn btn-md btn-trash bg-danger"><i class="fa fa-trash"></i></button>
              </form>
            </li>
          </ul>
        </th>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% elif context_view == 'record' %}
{% if context_type == 'ada' %}
<a href="{% url 'core:adaprint' pk=context_folder  %}" target="_blank" class="btn btn-md btn-primary"><i class="fa fa-print"></i> Print All</a>
{% elif context_type == 'itequipment' %}
<a href="{% url 'core:itprint' pk=context_folder  %}" target="_blank" class="btn btn-md btn-primary"><i class="fa fa-print"></i> Print All</a>
<a href="{% url 'core:generate_excel' folder=context_folder  %}" target="_blank" class="btn btn-md btn-primary"><i class="fa fa-file-excel-o"></i> Export Excel</a>
{% endif %}
<div class="panel-body">
  <table id="table" class="table table-striped table-bordered dt-responsive nowrap" style="width:100%">
    <thead>
      <tr>
        {% if context_type == 'ada' %}
        <th>Fullname</th>
        <th>Mobile</th>
        <th>Handset</th>
        <th></th>
        {% elif context_type == 'itequipment' %}
        <td></td>
        <th>Custodian</th>
        <th>Device</th>
        <th>Mobile</th>
        <th>IMEI</th>
        <th>ICCID</th>
        <th></th>
        {% endif %}
      </tr>
    </thead>
    <tbody>
      {% if context_type == 'ada' %}
        {% for field in object %}
        <tr>
          <td>{{ field.fullname }}</td>
          <td>{{ field.min }}</td>
          <td>{{ field.handset }}</td>
          <td>
            <ul class="list-inline">
              <li class="list-inline-item">
                <a href="{% url 'core:getadaprint' pk=field.pk %}" class="btn btn-md btn-primary" target="_blank"><i class="fa fa-print"></i></a>
              </li>
              <li>
                <a href="{% url 'core:updateada' pk=field.pk %}" class="btn btn-md btn-primary"><i class="fa fa-pencil"></i></a>
              </li>
            </ul>
          </td>
        </tr>
        {% endfor %}
      {% elif context_type == 'itequipment' %}
        {% for field in object %}
        <tr>
          <td>
            <form action="{% url 'core:claim' %}" method="post">
              {% csrf_token %}
              <input type="hidden" name="next" value="{{ request.path }}">
              <input type="hidden" name="pk" value="{{ field.pk }}">
              <button class="btn btn-md {% if field.is_claim %}btn-warning{% else %}btn-success{% endif %}">{% if field.is_claim %}<i class="fa fa-undo"></i> Undo Claim{% else %}<i class="fa fa-check"></i> Claim{% endif %}</button>
            </form>
          </td>
          <td>{{ field.custodian }}</td>
          <td>{{ field.device }}</td>
          <td>{{ field.mobile }}</td>
          <td>{{ field.imei }}</td>
          <td>{{ field.iccid }}</td>
          <td>
            <ul class="list-inline">
              <li class="list-inline-item">
                <a href="{% url 'core:getitprint' pk=field.pk %}" class="btn btn-md btn-primary" target="_blank"><i class="fa fa-print"></i></a>
              </li>
              <li>
                <a href="{% url 'core:updateit' pk=field.pk %}" class="btn btn-md btn-primary"><i class="fa fa-pencil"></i></a>
              </li>
            </ul>
          </td>
        </tr>
        {% endfor %}
      {% endif %}
    </tbody>
  </table>
</div>
{% endif %}
{% endblock %}
